<!DOCTYPE html>
<html lang="en">

<head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Infinite Engine</title>
        <script>
                window.$ = require('jquery');
        </script>
        <script src="../Core/Engine/StateManager.js"></script>
        <script src="../Core/Engine/ammo.wasm.js"></script>
        <script type="importmap">
                {
                    "imports": {
                        "three": "../three/build/three.module.js",
                        "three/addons/": "../three/examples/jsm/"
                    }
                }
        </script>
        <script type="module" src="../three/loadTHREE.js"></script>
        <link type="text/css" rel="stylesheet" href="../Core/GoldenLayout/goldenlayout-base.css" />
        <link type="text/css" rel="stylesheet" href="../Core/GoldenLayout/goldenlayout-dark-theme.css" />
        <link rel="stylesheet" href="../Core/GoldenLayout/ieTheme.css">
        <link rel="stylesheet" href="../Core/GoldenLayout/style.css">
        <script src="../Core/Engine/Console.js"></script>
</head>

<body>
        <svg style="position: absolute; top: 0px; left: 0px; z-index: 1234567889; display: none;" id="plSVG"  height="100vh" width="100vw">
                <line x1=0 y1=0 x2=500 y2="200" style="stroke:#333;stroke-width:5" id="PieLine" />
                Sorry, your browser does not support inline SVG.
        </svg>


        <script src="../Core/GoldenLayout/goldenlayout.min.js"></script>

        <script src="../Core/Engine/engine.js"></script>

        <div id="menu-bar"></div>
        <script type="module" src="../Global/menu.js"></script>

        <div id="welcomeScreen"></div>


        <div class="Editor" id="editor"></div>
        <script type="module" src="../Global/contentBrowser.js"></script>
        <script>
                window.IERenderer = (title, type, container) => {
                        async function get(html) {
                                return fetch(path.join(html, 'index.html'))
                                        .then(response => response.text())
                                        .then(data => {
                                                container.innerHTML = data.replace('layoutContainer', title);

                                                const scripts = container.getElementsByTagName('script');
                                                for (let i = 0; i < scripts.length; i++) {
                                                        const script = document.createElement('script');
                                                        script.type = scripts[i].type

                                                        if (scripts[i].src) {
                                                                const src = scripts[i].attributes.src.value
                                                                script.src = path.join(html, src);
                                                        } else {
                                                                script.textContent = scripts[i].textContent;
                                                        }

                                                        document.body.appendChild(script);
                                                }

                                                return data

                                        });
                        }


                        switch (type) {
                                case "Map":
                                        get('../LevelEditor')

                                        break;
                                case "UI":
                                        get('../UIEditor')
                                        break;
                                default:
                                        break;
                        }

                }
        </script>




        <template>
                <div class="container"
                        style="display: flex; flex-direction: column; align-items: center; justify-content: center; flex: 1; height: calc(100vh - 100px);">
                        <img draggable="false" src="../assets/Infinite Icon.png" alt="Infinite" height="200"
                                style="margin-top: 100px; filter: invert(1); opacity: 0.3;">
                        <div class="startupContainer" style="margin: 50px; margin-top: 100px;">
                                <button class="startupButton" style="background-color: #0090ff;"
                                        onclick="engine.createNewProject()">
                                        Create New
                                </button>
                                <button class="startupButton" onclick="engine.openNewProject()">
                                        Open Project
                                </button>
                                <a href="https://github.com/SterlyDolce/Infinite-Engine" target="_blank"
                                        class="startupButton">
                                        Github
                                </a>
                                <a href="https://threejs.org" target="_blank" class="startupButton">
                                        THREEJS
                                </a>
                        </div>
                </div>
        </template>
        <script>
                function showContent() {
                        let temp = document.getElementsByTagName("template")[0];
                        let w = document.getElementById("welcomeScreen");
                        let ws = document.createElement('div')
                        w.appendChild(ws)
                        let clon = temp.content.cloneNode(true);
                        ws.appendChild(clon);
                        document.addEventListener('closeWelcomePage', () => {
                                if (w.firstChild) {
                                        w.removeChild(w.firstChild);
                                }
                        });
                }


                engine.project ? null : showContent()

        </script>


        <script src="renderEditor.js"></script>


        <script type="module" src="../Core/ionicons/dist/ionicons/ionicons.esm.js"></script>
        <script nomodule src="../Core/ionicons/dist/ionicons/ionicons.js"></script>
</body>

</html>